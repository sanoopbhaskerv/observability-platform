<?xml version="1.0" encoding="UTF-8"?>
<!--
    Observability Platform â€” Default Logging Configuration
    
    Local (default):  Human-readable text with correlation_id in MDC
    Production (prod): JSON structured output for log aggregation (Loki, ELK, CloudWatch)
    
    Consuming apps can override this by placing their own logback-spring.xml
    in src/main/resources.
-->
<configuration>

    <!-- ===== LOCAL / DEFAULT PROFILE ===== -->
    <springProfile name="!prod">
        <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
            <encoder>
                <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight(%-5level) [%thread] [correlation_id=%X{correlation_id:-}] %cyan(%logger{36}) : %msg%n</pattern>
            </encoder>
        </appender>

        <root level="INFO">
            <appender-ref ref="CONSOLE" />
        </root>
    </springProfile>

    <!-- ===== PRODUCTION PROFILE ===== -->
    <springProfile name="prod">
        <appender name="JSON_CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
            <encoder class="ch.qos.logback.classic.encoder.JsonEncoder" />
        </appender>

        <root level="INFO">
            <appender-ref ref="JSON_CONSOLE" />
        </root>
    </springProfile>

</configuration>
